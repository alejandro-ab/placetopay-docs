export const description = 'sites';
import {ApiReader, CodeGroup, Col, Row} from "../../../../../components/mdx";
export const sectionMode = 'nav';
export const apiRefs = [
 '/api/admin/sites/edit',
 '/api/admin/sites/delete',
 '/api/admin/sites/index',
 '/api/admin/sites/show',
 '/api/admin/sites/create'
];

# Sites

The Sites API is designed to simplify the management of sites that belong to a merchant-consumer within the administrative environment. These sites act as integration points, enabling each merchant to connect independently and securely with tokenization and authorization services.

Through this API, you can register new sites, query them individually or via paginated lists, update their configuration, or delete them when no longer needed. Each site is always linked to a merchant and a consumer, and can be configured with parameters such as its name, notification URLs, security credentials, and activation dates.

The aim is to offer administrators a clear and secure way to manage these connection points. The following sections detail each available operation, the required fields, applicable validation rules, and examples of the response structure for each request.

<Note> All operations require authentication using valid credentials. More details are available in the authentication section of this documentation. </Note>

---

## Credential Creation

This operation allows you to register a new site within the administrative system environment. It is available only to authenticated users with the appropriate permissions and requires a valid credential to associate the site with an authorized merchant. This is mainly used in administrative environments, whether for testing or production, depending on the values provided.

Once created, the site is stored in the system with its corresponding configuration, activation status, and webhook parameters (if applicable). It can also be registered in test mode (`onTest`), which affects how it operates.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/create"
      method="post"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Request" tag="POST" label="/api/admin/sites/create">
      ```bash {{ title: 'Create Site (all fields)' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/create \
      -H "Content-Type: application/json" \
      -d '{
        "auth": {
          "login":"f329e676189bb2a447a17ea595153545",
          "tranKey":"coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
          "nonce":"MnFrcmZlYjQ0bXk=",
          "seed":"2025-07-03T20:28:43-05:00"
        },
        "data": {
          "name": "Site Test",
          "webhookURL": "https://webhook.site/asdads",
          "webhookSecret": "E0wWIBNtNr3GSF6G",
          "merchantId": "f1d0888b-f5a9-445a-8c54-dba63763fbc5",
          "onTest": true,
          "enabledAt": "2025-06-16T22:29:01+00:00"
        }
      }'
      ```
      ```bash {{ title: 'Create Site (only required)' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/create \
      -H "Content-Type: application/json" \
      -d '{
        "auth": {
          "login":"f329e676189bb2a447a17ea595153545",
          "tranKey":"coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
          "nonce":"MnFrcmZlYjQ0bXk=",
          "seed":"2025-07-03T20:28:43-05:00"
        },
        "data": {
          "name": "Site Test",
          "merchantId": "f1d0888b-f5a9-445a-8c54-dba63763fbc5"
        }
      }'
      ```
      ```bash {{ title: 'Error - Null name field' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/create \
      -H "Content-Type: application/json" \
      -d '{
        "auth": {
          "login":"f329e676189bb2a447a17ea595153545",
          "tranKey":"coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
          "nonce":"MnFrcmZlYjQ0bXk=",
          "seed":"2025-07-03T20:28:43-05:00"
        },
        "data": {
          "name": null,
          "webhookURL": "https://webhook.site/test",
          "webhookSecret": "E0wWIBNtNr3GSF6G",
          "merchantId": "f1d0888b-f5a9-445a-8c54-dba63763fbc5",
          "onTest": true,
          "enabledAt": "2025-06-16T22:29:01+00:00"
        }
      }'
      ```
      ```bash {{ title: 'Error - Invalid merchantId' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/create \
      -H "Content-Type: application/json" \
      -d '{
        "auth": {
          "login":"f329e676189bb2a447a17ea595153545",
          "tranKey":"coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
          "nonce":"MnFrcmZlYjQ0bXk=",
          "seed":"2025-07-03T20:28:43-05:00"
        },
        "data": {
          "name": "Site Test",
          "webhookURL": "https://webhook.site/test",
          "webhookSecret": "E0wWIBNtNr3GSF6G",
          "merchantId": "invalid",
          "onTest": true,
          "enabledAt": "2025-06-16T22:29:01+00:00"
        }
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/create"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Response">
      ```json {{ title: 'Successful Response' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-03T23:37:15+00:00"
        },
        "data": {
          "id": "9f4e4926-4783-44b9-a169-f3ad38e61bea"
        }
      }
      ```
      ```json {{ title: 'Failed Response' }}
      {
        "status": {
          "status": "FAILED",
          "reason": "BR",
          "message": "The data.name field is required.",
          "date": "2025-07-04T01:59:29+00:00"
        }
      }
      ```
    </CodeGroup>
  </Col>
</Row>

## Site Query

This operation allows querying detailed information about a site previously registered in the administrative system. It is exclusively available to authenticated users who have access and visibility permissions over the resource.

The response includes basic site information, its enablement status, test mode (`onTest`), and data related to the associated merchant and consumer. Additionally, if applicable, it returns the configured webhook settings.

This operation validates that the provided identifier exists and that the requesting user has authorized access to the resource, either through a direct relationship or via ACL exclusion rules.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/show"
      method="post"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Request" tag="POST" label="/api/admin/sites/show">
      ```bash {{ title: 'Query a site' }}
         curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/show \
         -H "Content-Type: application/json" \
         -d '{
        "auth": {
          "login": "1441d14df19ec88431e513bb990326e1",
          "tranKey": "DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=",
          "nonce": "enQ4dXh3YWhkMWM=",
          "seed": "2025-07-25T09:00:00-05:00"
        },
        "id": "9f4e4926-4783-44b9-a169-f3ad38e61bea"
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/show"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Response">
    ```json {{ title: 'Successful Response' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-25T09:00:02-05:00"
        },
        "data": {
          "id": "e32d7a3d-c2ee-4c1c-9623-920a8b1c82cd",
          "consumer": "a99ee271-ff14-47b1-97bc-3d9deeb1b91b",
          "name": "Example Site",
          "code": "SITE123",
          "url": "https://www.ejemplo.com",
          "type": "ECOMMERCE",
          "environment": "production",
          "isEnabled": true,
          "createdAt": "2025-07-25 09:00:02",
          "updatedAt": "2025-07-25 09:00:02"
        }
      }
    ```
    </CodeGroup>
  </Col>
</Row>

## Site Update

This operation allows modifying the attributes of an existing site in the administrative environment. It is designed to update only the fields included in the request, without altering the site's other values. It is available only to authenticated users with proper site management permissions.

Each editable attribute must be sent inside the `data` object, along with the required `id` field identifying the site to be updated. The operation is secure and controlled, preventing unauthorized modifications to fields like `merchant` or `consumer`.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/edit"
      method="post"
      type="request"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Request" tag="POST" label="/api/admin/sites/edit">
      ```bash {{ title: 'Edit a site' }}
         curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/edit \
         -H "Content-Type: application/json" \
         -d '{
        "auth": {
          "login": "1441d14df19ec88431e513bb990326e1",
          "tranKey": "DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=",
          "nonce": "enQ4dXh3YWhkMWM=",
          "seed": "2025-07-25T09:00:00-05:00"
        },
        "id": "9f4e4926-4783-44b9-a169-f3ad38e61bea",
         "data": {
           "name": "Updated test site",
           "webhookURL": "https://miwebhook.com/notificaciones",
           "webhookSecret": "clave-secreta-webhook",
           "onTest": false,
           "enabledAt": "2025-08-01T08:30:00-05:00"
         }
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/edit"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Response">
    ```json {{ title: 'Successful Response' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-25T14:01:22-05:00"
        },
        "data": {
          "id": "1f2c8c0a-9e2a-4e71-9431-364c4fa4b54b"
        }
      }
      ```
    ```json {{ title: 'Failed Response' }}
      {
        "status": {
          "status": "FAILED",
          "reason": "BR",
          "message": "The field 'webhookURL' is not a valid URL",
          "date": "2025-07-25T14:02:30-05:00"
        }
      }
    ```
    </CodeGroup>
  </Col>
</Row>

## Site Deletion

This operation allows deleting a previously registered site in the administrative system. It is exclusively available to authenticated users who have access and visibility permissions over the resource.

The response includes basic site information, enablement status, test mode (`onTest`), and data related to the associated merchant and consumer. Additionally, if applicable, it returns the configured webhook settings.

This operation validates that the provided identifier exists and that the requesting user has authorized access to the resource, either through direct relation or ACL exclusion rules.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/delete"
      method="post"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Request" tag="POST" label="/api/admin/sites/delete">
      ```bash {{ title: 'Successfully delete a site' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/delete \
        -H "Content-Type: application/json" \
        -d '{
          "auth": {
            "login": "f329e676189bb2a447a17ea595153545",
            "tranKey": "coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
            "nonce": "MnFrcmZlYjQ0bXk=",
            "seed": "2025-07-03T20:28:43-05:00"
          },
          "id": "9f4e4926-4783-44b9-a169-f3ad38e61bea"
        }'
      ```
      ```bash {{ title: 'Error - Site has associated tokens' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/delete \
        -H "Content-Type: application/json" \
        -d '{
          "auth": {
            "login": "f329e676189bb2a447a17ea595153545",
            "tranKey": "coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
            "nonce": "MnFrcmZlYjQ0bXk=",
            "seed": "2025-07-03T20:28:43-05:00"
          },
          "id": "9f4e4926-4783-44b9-a169-f3ad38e61bea"
        }'
      ```
      ```bash {{ title: 'Error - Invalid site ID' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/delete \
        -H "Content-Type: application/json" \
        -d '{
          "auth": {
            "login": "f329e676189bb2a447a17ea595153545",
            "tranKey": "coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
            "nonce": "MnFrcmZlYjQ0bXk=",
            "seed": "2025-07-03T20:28:43-05:00"
          },
          "id": "invalid"
        }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/delete"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Response">
      ```json {{ title: 'Successful response' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-04T14:50:00+00:00"
        }
      }
      ```
      ```json {{ title: 'Failed response - Site has tokens' }}
      {
        "status": {
          "status": "FAILED",
          "reason": "BR",
          "message": "The site has associated tokens.",
          "date": "2025-07-04T14:53:40+00:00"
        }
      }
      ```
      ```json {{ title: 'Failed response - Invalid ID' }}
      {
        "status": {
          "status": "FAILED",
          "reason": "BR",
          "message": "The selected id is invalid.",
          "date": "2025-07-04T14:54:02+00:00"
        }
      }
      ```
    </CodeGroup>
  </Col>
</Row>

---

## Site Listing

This operation retrieves a list of sites registered in the administrative system, returning a paginated set of results with the ability to apply multiple filters to narrow down the search. It can only be used by authenticated and authorized credentials, based on access permissions defined by the system.

The result includes basic information about each site, such as its identifier, related consumer and merchant data, name, webhook URLs, key dates, and its test or production status.

The system also supports exclusion mechanisms via ACLs, so certain sites may not appear depending on the access rules configured for the authenticated credential.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/index"
      method="post"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Request" tag="POST" label="/api/admin/sites/index">
      ```bash {{ title: 'List all sites' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/index \
        -H "Content-Type: application/json" \
        -d '{
          "auth": {
            "login": "f329e676189bb2a447a17ea595153545",
            "tranKey": "coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
            "nonce": "MnFrcmZlYjQ0bXk=",
            "seed": "2025-07-03T20:28:43-05:00"
          }
        }'
      ```
      ```bash {{ title: 'List sites by merchant' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/sites/index \
        -H "Content-Type: application/json" \
        -d '{
          "auth": {
            "login": "f329e676189bb2a447a17ea595153545",
            "tranKey": "coMTloZknUHnioHIKvJYq5d31fVhOdCrn3kaExSvTGo=",
            "nonce": "MnFrcmZlYjQ0bXk=",
            "seed": "2025-07-03T20:28:43-05:00"
          },
          "filter": {
            "merchant": "merchant_slug"
          }
        }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/sites/index"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Response">
      ```json {{ title: 'Successful response' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-04T15:03:00+00:00"
        },
        "sites": [
          {
            "id": "9f4e4926-4783-44b9-a169-f3ad38e61bea",
            "name": "Website XYZ",
            "slug": "website-xyz",
            "merchant": "merchant_slug",
            "environment": "sandbox",
            "url": "https://xyz.com",
            "created_at": "2025-07-01T12:30:00-05:00"
          },
          {
            "id": "e8933493-b4f1-44cb-b6c7-02db9f9e3b57",
            "name": "Site ABC",
            "slug": "site-abc",
            "merchant": "merchant_slug",
            "environment": "production",
            "url": "https://abc.com",
            "created_at": "2025-06-15T09:45:00-05:00"
          }
        ]
      }
      ```
    </CodeGroup>
  </Col>
</Row>
